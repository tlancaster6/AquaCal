# Module Dependency Graph
#
# Usage:
#   - "depends_on" lists modules that must be read to understand this module
#   - "status" is one of: not_started, stub, in_progress, implemented
#
# Query example (find what to read for a module):
#   grep -A 10 "^  src/aquacal/core/camera.py:" DEPENDENCIES.yaml

# === Project Setup (Phase 0) ===
# These are not modules but required setup files:
#   - pyproject.toml: Package configuration and dependencies
#   - src/aquacal/__init__.py: Package exports
#   - requirements.txt: Pip dependencies

modules:

  # === Config ===
  src/aquacal/config/schema.py:
    depends_on: []
    status: not_started
    description: Type definitions, dataclasses, configuration schema

  # === Utils ===
  src/aquacal/utils/transforms.py:
    depends_on: []
    status: not_started
    description: Rotation conversions, pose composition

  src/aquacal/utils/visualization.py:
    depends_on:
      - src/aquacal/config/schema.py
    status: not_started
    description: Plotting utilities for debugging

  # === Core ===
  src/aquacal/core/board.py:
    depends_on:
      - src/aquacal/config/schema.py
    status: not_started
    description: ChArUco board geometry and 3D point generation

  src/aquacal/core/camera.py:
    depends_on:
      - src/aquacal/config/schema.py
      - src/aquacal/utils/transforms.py
    status: not_started
    description: Camera model, projection, back-projection (no refraction)

  src/aquacal/core/interface_model.py:
    depends_on:
      - src/aquacal/config/schema.py
    status: not_started
    description: Refractive interface model, ray-plane intersection

  src/aquacal/core/refractive_geometry.py:
    depends_on:
      - src/aquacal/config/schema.py
      - src/aquacal/core/camera.py
      - src/aquacal/core/interface_model.py
    status: not_started
    description: Snell's law, ray tracing, refractive projection

  # === IO ===
  src/aquacal/io/video.py:
    depends_on: []
    status: not_started
    description: Video loading, frame extraction

  src/aquacal/io/detection.py:
    depends_on:
      - src/aquacal/config/schema.py
      - src/aquacal/core/board.py
    status: not_started
    description: ChArUco detection wrapper

  src/aquacal/io/serialization.py:
    depends_on:
      - src/aquacal/config/schema.py
    status: not_started
    description: Save/load calibration results

  # === Calibration ===
  src/aquacal/calibration/intrinsics.py:
    depends_on:
      - src/aquacal/config/schema.py
      - src/aquacal/core/camera.py
      - src/aquacal/core/board.py
      - src/aquacal/io/detection.py
    status: not_started
    description: Stage 1 - per-camera intrinsic calibration

  src/aquacal/calibration/extrinsics.py:
    depends_on:
      - src/aquacal/config/schema.py
      - src/aquacal/core/camera.py
      - src/aquacal/core/board.py
      - src/aquacal/io/detection.py
      - src/aquacal/utils/transforms.py
    status: not_started
    description: Stage 2 - extrinsic initialization via pose graph

  src/aquacal/calibration/interface_estimation.py:
    depends_on:
      - src/aquacal/config/schema.py
      - src/aquacal/core/camera.py
      - src/aquacal/core/interface_model.py
      - src/aquacal/core/refractive_geometry.py
      - src/aquacal/core/board.py
    status: not_started
    description: Stage 3 - interface and board pose optimization

  src/aquacal/calibration/refinement.py:
    depends_on:
      - src/aquacal/config/schema.py
      - src/aquacal/calibration/interface_estimation.py
    status: not_started
    description: Stage 4 - optional joint refinement

  src/aquacal/calibration/pipeline.py:
    depends_on:
      - src/aquacal/config/schema.py
      - src/aquacal/io/video.py
      - src/aquacal/io/detection.py
      - src/aquacal/io/serialization.py
      - src/aquacal/calibration/intrinsics.py
      - src/aquacal/calibration/extrinsics.py
      - src/aquacal/calibration/interface_estimation.py
      - src/aquacal/calibration/refinement.py
      - src/aquacal/validation/reprojection.py
      - src/aquacal/validation/reconstruction.py
    status: not_started
    description: End-to-end calibration orchestration

  # === Triangulation ===
  src/aquacal/triangulation/triangulate.py:
    depends_on:
      - src/aquacal/config/schema.py
      - src/aquacal/core/refractive_geometry.py
    status: not_started
    description: Refractive triangulation for 3D reconstruction

  # === Validation ===
  src/aquacal/validation/reprojection.py:
    depends_on:
      - src/aquacal/config/schema.py
      - src/aquacal/core/refractive_geometry.py
    status: not_started
    description: Reprojection error computation

  src/aquacal/validation/reconstruction.py:
    depends_on:
      - src/aquacal/config/schema.py
      - src/aquacal/triangulation/triangulate.py
      - src/aquacal/core/board.py
    status: not_started
    description: 3D reconstruction metrics using ChArUco geometry

  src/aquacal/validation/diagnostics.py:
    depends_on:
      - src/aquacal/config/schema.py
      - src/aquacal/validation/reprojection.py
      - src/aquacal/validation/reconstruction.py
    status: not_started
    description: Detailed error analysis and reporting
