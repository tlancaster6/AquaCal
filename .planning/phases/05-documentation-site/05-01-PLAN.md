---
phase: 05-documentation-site
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - docs/conf.py
  - docs/index.md
  - docs/overview.md
  - docs/guide/index.md
  - docs/tutorials/index.md
  - docs/contributing.md
  - docs/changelog.md
  - pyproject.toml
  - .readthedocs.yaml
autonomous: true

must_haves:
  truths:
    - "Sphinx builds successfully with Furo theme, MyST, and autodoc"
    - "Landing page has feature highlights, quick start code, badges, and section links"
    - "Site navigation has Overview, User Guide, API Reference, Tutorials (coming soon), Contributing sections"
    - "Read the Docs configuration exists and would build correctly"
  artifacts:
    - path: "docs/conf.py"
      provides: "Complete Sphinx configuration with all extensions"
      contains: "furo"
    - path: "docs/index.md"
      provides: "Rich landing page with sphinx-design grid cards"
      contains: "grid-item-card"
    - path: "docs/overview.md"
      provides: "Conceptual overview: What is refractive calibration?"
    - path: ".readthedocs.yaml"
      provides: "RTD build configuration"
      contains: "sphinx"
    - path: "pyproject.toml"
      provides: "docs optional dependency group"
      contains: "furo"
  key_links:
    - from: "docs/index.md"
      to: "docs/overview.md"
      via: "toctree and card link"
    - from: ".readthedocs.yaml"
      to: "docs/conf.py"
      via: "sphinx.configuration"
---

<objective>
Set up Sphinx documentation infrastructure with Furo theme, MyST Markdown, all required extensions, site skeleton with landing page, conceptual overview, placeholder pages for guide/tutorials, and Read the Docs configuration.

Purpose: Foundation for all documentation content — theory pages (Plan 02) and API reference (Plan 03) build on this skeleton.
Output: Working Sphinx build with navigable site structure, rich landing page, and RTD deployment config.
</objective>

<execution_context>
@C:/Users/tucke/.claude/get-shit-done/workflows/execute-plan.md
@C:/Users/tucke/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/05-documentation-site/05-RESEARCH.md
@.planning/phases/05-documentation-site/05-CONTEXT.md
@docs/conf.py
@pyproject.toml
</context>

<tasks>

<task type="auto">
  <name>Task 1: Sphinx configuration, dependencies, and RTD config</name>
  <files>
    docs/conf.py
    pyproject.toml
    .readthedocs.yaml
  </files>
  <action>
  1. Update `pyproject.toml` to add `docs` optional dependency group:
     ```toml
     docs = [
         "sphinx>=6.2",
         "furo",
         "myst-parser",
         "sphinx-copybutton",
         "sphinx-design",
     ]
     ```

  2. Rewrite `docs/conf.py` with complete configuration:
     - `sys.path.insert(0, str(Path(__file__).parent.parent / "src"))` for autodoc imports
     - Extensions: `sphinx.ext.autodoc`, `sphinx.ext.napoleon`, `sphinx.ext.viewcode`, `sphinx.ext.intersphinx`, `sphinx.ext.mathjax`, `myst_parser`, `sphinx_copybutton`, `sphinx_design`
     - `html_theme = "furo"` with theme options (brand colors, sidebar settings)
     - `html_title = "AquaCal"`
     - `intersphinx_mapping` for python, numpy, scipy, opencv
     - `myst_enable_extensions = ["colon_fence", "dollarmath"]` for MyST admonitions and inline math
     - `napoleon_google_docstring = True`, `napoleon_numpy_docstring = False`
     - `autodoc_member_order = "bysource"`
     - `autodoc_typehints = "description"`
     - Build-time diagram generation hook: `setup(app)` function that runs `docs/guide/_diagrams/generate_all.py` via subprocess during `config-inited` event. Use `matplotlib.use('Agg')` for headless. Create the `_diagrams` directory and an empty `generate_all.py` placeholder (Plan 02 fills it in).
     - Delete the old `docs/index.rst` file since we're moving to `docs/index.md` (MyST)

  3. Create `.readthedocs.yaml`:
     ```yaml
     version: 2
     build:
       os: ubuntu-24.04
       tools:
         python: "3.10"
     sphinx:
       configuration: docs/conf.py
     python:
       install:
         - method: pip
           path: .
           extra_requirements:
             - docs
     ```

  4. Install docs dependencies locally: `pip install -e ".[docs]"`
  </action>
  <verify>
  Run `pip install -e ".[docs]"` successfully. Verify `python -c "import furo; import myst_parser; import sphinx_design"` imports without error.
  </verify>
  <done>
  `pyproject.toml` has docs extras, `docs/conf.py` is fully configured with Furo theme and all extensions, `.readthedocs.yaml` exists with correct build spec, docs dependencies install cleanly.
  </done>
</task>

<task type="auto">
  <name>Task 2: Landing page, overview, and site skeleton</name>
  <files>
    docs/index.md
    docs/overview.md
    docs/guide/index.md
    docs/tutorials/index.md
    docs/contributing.md
    docs/changelog.md
  </files>
  <action>
  1. Delete `docs/index.rst` (replaced by `docs/index.md`).

  2. Create `docs/index.md` — rich landing page with:
     - Badges (Build, Coverage, PyPI, Python, License)
     - One-paragraph description of AquaCal
     - `sphinx-design` grid cards linking to: Overview, User Guide, API Reference, Tutorials
     - Quick Start section with ~5-line Python code snippet showing `run_calibration` and `load_calibration`
     - Hidden toctree for sidebar navigation ordering:
       ```
       :::{toctree}
       :hidden:
       :maxdepth: 2

       overview
       guide/index
       api/index
       tutorials/index
       contributing
       changelog
       :::
       ```

  3. Create `docs/overview.md` — "What is Refractive Calibration?":
     - Explain the physical problem: cameras in air viewing underwater targets
     - Simple ASCII diagram showing camera array, water surface, underwater target
     - Why standard calibration fails (ignores refraction at air-water interface)
     - What AquaCal does: models Snell's law refraction for accurate calibration
     - Links to the three theory detail pages (geometry, coordinates, optimizer)
     - Accessible tone — no math equations, just intuition. 200-300 words.

  4. Create `docs/guide/index.md` — User Guide landing:
     - Brief intro: "These pages explain the theory behind AquaCal's calibration."
     - Links to three theory pages (as toctree entries — pages created in Plan 02):
       - Refractive Geometry
       - Coordinate Conventions
       - Optimizer Pipeline
     - Use toctree with placeholder entries (files created in Plan 02)

  5. Create `docs/tutorials/index.md` — Tutorials placeholder:
     - Title: "Tutorials"
     - Body: brief note that interactive Jupyter notebook tutorials are coming soon
     - Mention what will be covered: full pipeline walkthrough, diagnostics, synthetic data

  6. Create `docs/contributing.md`:
     - Use MyST `{include}` directive to pull from `../CONTRIBUTING.md`
     - Or create a brief page linking to the GitHub CONTRIBUTING.md

  7. Create `docs/changelog.md`:
     - Use MyST `{include}` directive to pull from `../CHANGELOG.md`

  8. Verify Sphinx builds: `python -m sphinx docs docs/_build -b html -W` (warnings as errors).
     If there are warnings about missing toctree entries for guide pages not yet created, add `:orphan:` or stub files as needed. The key goal is a clean build.
  </action>
  <verify>
  `python -m sphinx docs docs/_build -b html` builds without errors. Open `docs/_build/index.html` to verify landing page renders with grid cards and navigation sidebar.
  </verify>
  <done>
  Landing page has badges, grid cards, and quick start code. Overview page explains refractive calibration conceptually. Sidebar navigation shows all sections. Tutorials section has "coming soon" placeholder. Sphinx builds cleanly.
  </done>
</task>

</tasks>

<verification>
1. `pip install -e ".[docs]"` installs without errors
2. `python -m sphinx docs docs/_build -b html` builds without errors
3. Landing page (`docs/_build/index.html`) displays badges, grid cards, and quick start
4. Sidebar shows: Overview | User Guide | API Reference | Tutorials | Contributing | Changelog
5. Overview page explains refractive calibration concept with ASCII diagram
6. `.readthedocs.yaml` exists at repository root
</verification>

<success_criteria>
Sphinx documentation site skeleton builds cleanly with Furo theme. Landing page is rich and navigable. All section placeholders exist. RTD configuration is ready for deployment.
</success_criteria>

<output>
After completion, create `.planning/phases/05-documentation-site/05-01-SUMMARY.md`
</output>
