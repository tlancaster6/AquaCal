---
phase: 10-documentation-audit
plan: 03
type: execute
wave: 2
depends_on: ["10-01", "10-02"]
files_modified:
  - docs/guide/index.md
  - docs/guide/cli.md
  - docs/guide/troubleshooting.md
  - docs/guide/glossary.md
  - docs/guide/optimizer.md
  - docs/index.md
  - docs/overview.md
autonomous: false
must_haves:
  truths:
    - "CLI usage guide exists with reference-style documentation of all commands, flags, and options"
    - "Camera model documentation exists covering standard 5-param, rational 8-param, fisheye 4-param, and auto-simplification"
    - "Troubleshooting section exists with practical tips (reference camera choice, frame_step, max_calibration_frames)"
    - "Allowed camera combinations are documented"
    - "A glossary section exists defining domain terms (water_z, extrinsics, board pose, etc.)"
    - "User has reviewed and approved the audit findings and applied fixes"
  artifacts:
    - path: "docs/guide/cli.md"
      provides: "CLI reference documentation"
      contains: "aquacal calibrate"
    - path: "docs/guide/troubleshooting.md"
      provides: "Practical troubleshooting tips"
      contains: "reference camera"
    - path: "docs/guide/glossary.md"
      provides: "Domain glossary"
      contains: "water_z"
  key_links:
    - from: "docs/guide/index.md"
      to: "docs/guide/cli.md"
      via: "toctree entry"
      pattern: "cli"
    - from: "docs/guide/index.md"
      to: "docs/guide/troubleshooting.md"
      via: "toctree entry"
      pattern: "troubleshooting"
    - from: "docs/guide/index.md"
      to: "docs/guide/glossary.md"
      via: "toctree entry"
      pattern: "glossary"
---

<objective>
Apply user-approved audit fixes, create new documentation sections (CLI guide, camera models, troubleshooting, glossary, camera combinations), and fix docstring issues identified in Plan 01.

Purpose: This plan resolves all 6 accumulated documentation todos and applies fixes from the audit report. It depends on Plan 01 (audit report for user review) and Plan 02 (rename complete so new docs use `water_z`).
Output: New documentation pages, fixed docstrings, consistent terminology across codebase.
</objective>

<execution_context>
@C:/Users/tucke/.claude/get-shit-done/workflows/execute-plan.md
@C:/Users/tucke/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/10-documentation-audit/10-CONTEXT.md
@.planning/phases/10-documentation-audit/10-01-SUMMARY.md
@.planning/phases/10-documentation-audit/10-02-SUMMARY.md
@src/aquacal/cli.py
@src/aquacal/core/camera.py
@src/aquacal/config/schema.py
@docs/guide/index.md
@docs/guide/optimizer.md
</context>

<tasks>

<task type="checkpoint:human-verify">
  <name>Task 1: User reviews audit findings report</name>
  <files>.planning/phases/10-documentation-audit/10-01-AUDIT-REPORT.md</files>
  <action>
    Plan 01 produced a comprehensive audit report at `.planning/phases/10-documentation-audit/10-01-AUDIT-REPORT.md`
    covering docstring issues, Sphinx documentation issues, spelling checks, terminology analysis, and documentation gaps.

    Present the audit report to the user for review:
    1. Read `.planning/phases/10-documentation-audit/10-01-AUDIT-REPORT.md`
    2. Summarize the key findings by category (Errors, Inconsistencies, Gaps, Terminology)
    3. Ask user which findings to fix and which to skip
    4. Ask if there are additional issues not captured in the report
  </action>
  <verify>User has reviewed the audit report and provided feedback on which fixes to apply</verify>
  <done>User has approved the audit findings (all or subset) and Task 2 can proceed with applying fixes</done>
</task>

<task type="auto">
  <name>Task 2: Create new documentation sections and apply audit fixes</name>
  <files>
    docs/guide/cli.md
    docs/guide/troubleshooting.md
    docs/guide/glossary.md
    docs/guide/optimizer.md
    docs/guide/index.md
    docs/index.md
    docs/overview.md
  </files>
  <action>
Create all new documentation sections from the 6 pending doc todos, and apply user-approved fixes from the audit report.

**New file: `docs/guide/cli.md` — CLI Reference**
- Reference-style documentation (not workflow walkthrough, per locked decision)
- Document all three commands: `calibrate`, `init`, `compare`
- For each command: syntax, all flags/options with descriptions, brief usage examples
- Read `src/aquacal/cli.py` to extract all argparse arguments accurately
- Include the `--version` flag
- Use consistent formatting: command name as heading, flags in a table or definition list

**New section in `docs/guide/optimizer.md` — Camera Models**
- Add to existing page (per locked decision: not a standalone page)
- Document standard 5-param (k1, k2, p1, p2, k3), rational 8-param (k1-k6, p1, p2), fisheye 4-param (k1-k4 equidistant)
- Document auto-simplification logic (only for standard model): reference git commit 0863fae to understand the logic, then describe in user terms
- Include signs of overfitting and when to downgrade from rational/fisheye to standard
- Document allowed combinations of `auxiliary_cameras`, `fisheye_cameras`, and `rational_model_cameras` — read `schema.py` and `pipeline.py` to determine valid combinations

**New file: `docs/guide/troubleshooting.md` — Troubleshooting**
- Practical "if you see X, try Y" format (per user specifics)
- Include these tips:
  1. Reference camera choice: extrinsic calibration quality depends on reference camera. Set reference camera to whichever had lowest RMS in Stage 1 (printed to console during calibrate)
  2. Bad RMS or high round-trip errors in Stage 1: lower `frame_step` for more intrinsic data, optionally set `max_calibration_frames` to limit expensive Stage 3/4 optimization
  3. Document the three camera models with signs of overfitting (cross-reference the camera models section in optimizer.md)
- Add additional troubleshooting items based on common calibration issues (e.g., disconnected pose graph, too few shared observations)

**New file: `docs/guide/glossary.md` — Glossary**
- Define domain-specific terms that trip up newcomers
- Minimum terms: `water_z`, extrinsics, intrinsics, board pose, interface normal, refractive projection, ChArUco board, pose graph, bundle adjustment, reference camera, auxiliary camera, validation set
- Brief, precise definitions — one sentence each where possible
- Include units where relevant (e.g., "water_z: Z-coordinate of the water surface in world frame, in meters")

**Update `docs/guide/index.md`**
- Add new pages to the toctree and page listing: cli, troubleshooting, glossary
- Update descriptions to reflect new content

**Update `docs/index.md`**
- Ensure landing page reflects the expanded documentation structure
- State "all values in meters" in a prominent location (per locked decision on units convention)

**Apply audit fixes**
- Apply all user-approved fixes from the audit report (docstring corrections, formatting fixes, terminology standardizations)
- For terminology: standardize on consistent terms per the audit findings (e.g., "calibration board" vs "ChArUco board" — use whatever the audit recommended, or default to "ChArUco board" for specificity and "board" for brevity)
- Fix any docstring style issues flagged in the audit (Google-style format, imperative tense, missing Args/Returns sections)
  </action>
  <verify>
- All new files exist: `docs/guide/cli.md`, `docs/guide/troubleshooting.md`, `docs/guide/glossary.md`
- `docs/guide/index.md` includes new pages in toctree
- `docs/guide/optimizer.md` contains camera model section
- CLI guide documents all three commands with all flags
- Troubleshooting contains the three required tips
- Glossary contains at least 12 domain terms
- Optionally run `sphinx-build docs docs/_build -W` to check for build errors (Claude's discretion)
  </verify>
  <done>All 6 documentation todos resolved; new pages created and linked; audit fixes applied; documentation has consistent terminology and formatting.</done>
</task>

</tasks>

<verification>
- New documentation pages exist and are linked from the guide index
- CLI guide accurately reflects all argparse arguments in `cli.py`
- Camera model documentation covers all three models + auto-simplification
- Troubleshooting section has practical "if X, try Y" format
- Glossary defines domain terms
- All user-approved audit fixes applied
- Documentation uses `water_z` (not `interface_distance`) throughout
</verification>

<success_criteria>
- All 6 accumulated documentation todos are resolved
- User has reviewed and approved audit findings
- New documentation sections are accurate, well-formatted, and linked into the Sphinx toctree
- Terminology is consistent across all documentation
- Docstring style is unified (Google-style, imperative tense)
</success_criteria>

<output>
After completion, create `.planning/phases/10-documentation-audit/10-03-SUMMARY.md`
</output>
