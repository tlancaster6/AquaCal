---
phase: 12-tutorial-verification
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - docs/tutorials/01_full_pipeline.ipynb
  - docs/tutorials/02_diagnostics.ipynb
  - docs/tutorials/03_synthetic_validation.ipynb
  - docs/tutorials/02_synthetic_validation.ipynb
  - docs/tutorials/index.md
autonomous: true
must_haves:
  truths:
    - "Tutorial 01 contains curated diagnostics content merged from old tutorial 02"
    - "Old tutorial 02 (diagnostics standalone) no longer exists"
    - "Former tutorial 03 is now tutorial 02 (renamed file)"
    - "Tutorial index reflects 2-tutorial structure"
    - "Tutorial 01 summary links to tutorial 02 as next step"
  artifacts:
    - path: "docs/tutorials/01_full_pipeline.ipynb"
      provides: "Pipeline tutorial with merged diagnostics"
      contains: "reprojection_error"
    - path: "docs/tutorials/02_synthetic_validation.ipynb"
      provides: "Renamed placeholder (will be rewritten in Plan 02)"
    - path: "docs/tutorials/index.md"
      provides: "Updated tutorial listing with 2 tutorials"
      contains: "02_synthetic_validation"
  key_links:
    - from: "docs/tutorials/01_full_pipeline.ipynb"
      to: "docs/tutorials/02_synthetic_validation.ipynb"
      via: "forward link in summary cell"
      pattern: "02_synthetic_validation"
    - from: "docs/tutorials/index.md"
      to: "docs/tutorials/01_full_pipeline.ipynb"
      via: "toctree entry"
      pattern: "01_full_pipeline"
---

<objective>
Restructure tutorials from 3 to 2: merge diagnostics into tutorial 01, delete old tutorial 02, rename 03 to 02, and update the index page.

Purpose: Create a clean 2-tutorial structure (practical pipeline + scientific validation) per user decision.
Output: Restructured tutorial 01 with diagnostics, renamed tutorial 02 file, updated index.
</objective>

<execution_context>
@C:/Users/tucke/.claude/get-shit-done/workflows/execute-plan.md
@C:/Users/tucke/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@docs/tutorials/01_full_pipeline.ipynb
@docs/tutorials/02_diagnostics.ipynb
@docs/tutorials/03_synthetic_validation.ipynb
@docs/tutorials/index.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Merge diagnostics into tutorial 01 and restructure files</name>
  <files>
    docs/tutorials/01_full_pipeline.ipynb
    docs/tutorials/02_diagnostics.ipynb
    docs/tutorials/03_synthetic_validation.ipynb
    docs/tutorials/02_synthetic_validation.ipynb
  </files>
  <action>
Merge a curated subset of diagnostics content from tutorial 02 into tutorial 01 to create a "pipeline + diagnose" flow. Use Claude's discretion to pick the most valuable diagnostics. Recommended inclusions:

1. **Per-camera reprojection error bar chart** (cell 6 from tutorial 02) — essential for spotting problematic cameras
2. **Reprojection error histogram** (cell 7) — shows overall error distribution
3. **Interface distance recovery comparison** (cell 10) — validates the key refractive parameter
4. **3D reconstruction error** (cell 15) — the ultimate quality metric
5. **Common issues checklist table** (cell 16) — practical troubleshooting reference

Skip: spatial error heatmap (cell 8), camera Z position comparison (cell 11), multi-panel 3D rig visualization (cell 13) — these are less essential for a pipeline walkthrough.

Integration approach:
- After the current "Stage 3" section in tutorial 01, add a new "## Diagnostics" section
- The diagnostics content must actually run calibration (tutorial 01 currently uses ground truth parameters). Adapt the diagnostic cells to work with the tutorial 01 data flow:
  - If DATA_SOURCE == "synthetic": run Stages 2-3 calibration (like tutorial 02 does) so there are real optimization results to diagnose. Use the calibration code pattern from tutorial 02 cells 3-4.
  - If DATA_SOURCE == "preset" or "zenodo": same approach
- After diagnostics, keep the existing Stage 4, Validation, and Summary sections
- Update the Summary cell: remove link to "Diagnostics and Troubleshooting" tutorial (it no longer exists), keep link to "Synthetic Validation" but update path to `02_synthetic_validation.ipynb`, add text: "Next: explore why refractive calibration matters with controlled experiments"

After editing tutorial 01:
- Delete `docs/tutorials/02_diagnostics.ipynb` (git rm)
- Rename `docs/tutorials/03_synthetic_validation.ipynb` to `docs/tutorials/02_synthetic_validation.ipynb` (git mv)

Clear all cell outputs from tutorial 01 after editing (set all outputs to empty arrays in the ipynb JSON). The notebook will be re-executed in Plan 02.

Update the Colab badge URL in tutorial 01 to point to the correct GitHub path (tlancaster6/AquaCal).
  </action>
  <verify>
- `docs/tutorials/01_full_pipeline.ipynb` exists and contains "Diagnostics" section with reprojection error analysis
- `docs/tutorials/02_diagnostics.ipynb` does NOT exist
- `docs/tutorials/02_synthetic_validation.ipynb` exists (renamed from 03)
- `docs/tutorials/03_synthetic_validation.ipynb` does NOT exist
- Tutorial 01 summary cell links to `02_synthetic_validation.ipynb`
- `python -c "import json; nb=json.load(open('docs/tutorials/01_full_pipeline.ipynb')); print('cells:', len(nb['cells']))"` shows increased cell count
  </verify>
  <done>Tutorial 01 has merged diagnostics content, old tutorial 02 is deleted, tutorial 03 is renamed to 02</done>
</task>

<task type="auto">
  <name>Task 2: Update tutorial index for 2-tutorial structure</name>
  <files>docs/tutorials/index.md</files>
  <action>
Rewrite `docs/tutorials/index.md` to reflect the new 2-tutorial structure:

1. Remove the stale "Phase 6" note
2. Update descriptions for the practical-to-scientific arc:
   - **Tutorial 01**: "Calibrate Your Rig" (or similar inviting title) — end-to-end calibration pipeline with diagnostics. Covers data loading, all four stages, reprojection analysis, 3D validation, and troubleshooting.
   - **Tutorial 02**: "Why Refractive Calibration Matters" (or similar) — synthetic validation with three experiments showing parameter fidelity, depth generalization, and accuracy scaling.
3. Update toctree to list only `01_full_pipeline` and `02_synthetic_validation`
4. Use a brief guide format (short paragraph per tutorial describing what the user will learn and when to use it)
  </action>
  <verify>
- `docs/tutorials/index.md` references exactly 2 tutorials
- No mention of `02_diagnostics` or `03_synthetic_validation`
- Toctree has `01_full_pipeline` and `02_synthetic_validation`
  </verify>
  <done>Index page reflects 2-tutorial structure with updated descriptions and correct toctree</done>
</task>

</tasks>

<verification>
- Only 2 tutorial notebooks exist in `docs/tutorials/`: `01_full_pipeline.ipynb` and `02_synthetic_validation.ipynb`
- Tutorial 01 contains diagnostics section
- Index page lists exactly 2 tutorials
- No broken cross-references between tutorials
</verification>

<success_criteria>
Tutorial structure is reorganized from 3 to 2 tutorials. Tutorial 01 includes merged diagnostics. Files are renamed and index is updated. Ready for tutorial 02 rewrite and execution in Plan 02.
</success_criteria>

<output>
After completion, create `.planning/phases/12-tutorial-verification/12-01-SUMMARY.md`
</output>
